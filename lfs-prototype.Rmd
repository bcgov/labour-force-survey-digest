---
title: "Labour Force Survey: British Columbia"
output: 
  flexdashboard::flex_dashboard:
    theme: yeti
    orientation: rows
    vertical_layout: scroll
    social: menu
    source_code: https://github.com/bcgov/labour-force-survey-digest
---


<!--
Copyright 2020 Province of British Columbia

Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at

http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and limitations under the License.
-->


```{r setup, include=FALSE, cache=TRUE}
##load libraries in setup.R
source("setup.R")

##source data
##source("get-data.R")
lfc_province_tidy <- readRDS("tmp/lfc_province_tidy.rds")
lfc_region_tidy <- readRDS("tmp/lfc_region_tidy.rds")
employment_by_class_tidy <- readRDS("tmp/employment_by_class_tidy.rds")
can_provinces <- readRDS("tmp/can_provinces.rds")

##report month
report_month <- lfc_province_tidy %>%
  filter(vector == "v2064705",
         date == max(date)) %>%
  pull(date) %>%
  month(label = TRUE, abbr = FALSE)

##report year
report_year <- lfc_province_tidy %>%
  filter(vector == "v2064705",
         date == max(date)) %>%
  pull(date) %>%
  year()

previous_year <- report_year - 1

##common chart themes
theme_bar <- theme(
  axis.line = element_line(colour = "grey70", size = .1),
  axis.text = element_text(size = 9),
  legend.text = element_text(size = 11, colour = "grey20")
)

theme_vert_bar <- theme_bar +
  theme(
    panel.grid.major.x = element_blank(),
    panel.grid.minor.x = element_blank()
  )

theme_horiz_bar <- theme_bar +
  theme(
    panel.grid.major.y = element_blank(),
    panel.grid.minor.y = element_blank()
  )

theme_facet_bar <- theme_vert_bar +
  theme(
    axis.text.y = element_text(size = 9),
    axis.text.x = element_text(size = 8),
    strip.text = element_text(size = 11, colour = "grey20"),
    legend.text = element_text(size = 11, colour = "grey20")
  )

##colours
main_colour <- "#1d91c0"

##custom
ggplotly_lfs <- function(...) {
  ggplotly(..., tooltip = c("text"))
}
```


Sidebar {.sidebar}
=======================================================================


## `r paste(report_month, report_year)`

<br>

Labour Force Survey Summary for British Columbia:

 - [Highlights]
 - [Sector]
 - [Industry]
 - [National ðŸ‡¨ðŸ‡¦]

<br>

ðŸ–± Click or tap on graphs for interactive options:

![](images/plotly-options.png){width=90%}

<br>

Learn more [About] the Statistics Canada Labour Force Survey.


Highlights
======================================================================


Row 1
----------------------------------------------------------------------

### B.C. Unemployment Rate (%) for Recent Month {.value-box}

```{r}
##recent monthly change in unemployment
recent_month_unemployment_rate_bc <- lfc_province_tidy %>%
  filter(
    vector == "v2064705",
    date == max(date)
  )

valueBox(
  value = recent_month_unemployment_rate_bc %>%
    pull(value) %>%
    signs(format = percent, accuracy = 0.1),
  # icon = "fa-users-cog",
  caption = paste("B.C. Unemployment Rate in", report_month)
)
```

### Month-Over-Month Change in Recent B.C. Unemployment Rate (%) {.value-box}

```{r}
valueBox(
  value = recent_month_unemployment_rate_bc %>%
    pull(month_change) %>%
    signs(format = percent, accuracy = 0.1),
  # icon = "fa-users-cog",
  caption = "Month-Over-Month Change in B.C. Unemployment Rate"
)
```

### Year-Over-Year Change in Recent B.C. Unemployment Rate (%) {.value-box}

```{r}
##year over year change unemployment rate
year_change_unemployment_rate_bc <- lfc_province_tidy %>%
  filter(
    vector == "v2064705",
    date %in% c(max(date) - months(12), max(date))
  ) %>%
  mutate(year_change = value - lag(value)) %>%
  filter(date == max(date))

valueBox(
  value = year_change_unemployment_rate_bc %>%
    pull(year_change) %>%
    signs(
      format = percent,
      add_plusses = TRUE,
      accuracy = 0.1
    ),
  # icon = "fa-users-cog",
  caption = paste("Year-Over-Year Change in B.C. Unemployment Rate")
)
```


Row 2
----------------------------------------------------------------------

### Monthly B.C. Unemployment Rates Since 1980 

```{r, fig.width=7, fig.height=5}
unemployrt_pre_thisyear <- lfc_province_tidy %>%
  filter(vector == "v2064705",
         date > "1979-12-31" & date < paste0(report_year, "-01-01"))

unemployrt_thisyear <- lfc_province_tidy %>%
  filter(vector == "v2064705",
         date >= paste0(report_year, "-01-01"))

ggplotly_lfs(ggplot() +
  geom_point(
    data = unemployrt_thisyear,
    aes(
      x = date,
      y = value,
      text = paste(
        "Date:",
        date,
        "<br>",
        "Unemployment Rate:",
        signs(value,
              format = percent,
              accuracy = 0.1)
      )
    ),
    colour = main_colour,
    alpha = 0.8
  ) +
  geom_point(
    data = unemployrt_pre_thisyear,
    aes(
      x = date,
      y = value,
      text = paste(
        "Date:",
        date,
        "<br>",
        "Unemployment Rate:",
        signs(value,
              format = percent,
              accuracy = 0.1)
      )
    ),
    colour = "grey50",
    alpha = 0.8
  ) +
  geom_line(
    data = unemployrt_thisyear,
    aes(x = date,
        y = value),
    colour = main_colour,
    alpha = 0.8
  ) +
  geom_line(
    data = unemployrt_pre_thisyear,
    aes(x = date,
        y = value),
    colour = "grey50",
    alpha = 0.8
  ) +
  labs(x = NULL, y = NULL) +
  scale_y_continuous(labels = percent,
                     breaks = breaks_pretty(n = 6)) +
  theme_minimal() +
  theme_vert_bar
)
```

### Unemployment Rates for `r paste(report_month, report_year)` by B.C. Economic Region 

```{r, fig.width=7, fig.height=5}
# ggplotly_lfs(
  lfc_region_tidy %>%
    filter(
      geo != "British Columbia",
      labour_force_characteristics == "Unemployment rate",
      date == max(date)
    ) %>%
    mutate(geo_label = str_wrap(str_extract(geo, "^([^,])+"), width = 10)) %>%
    ggplot() +
    geom_sf(
      aes(
        fill = value,
        text = paste0(
          "Region: ",
          geo_label,
          "<br>",
          "Date: ",
          date,
          "<br>",
          "Unemployment Rate: ",
          signs(value,
                format = percent,
                accuracy = 0.1)
        )
      ),
      colour = "white",
      lwd = .2
    ) +
    geom_sf_text(aes(label = geo_label),
                 size = 3.5,
                 colour = "grey20") +
    # coord_sf(datum = NA) +
    labs(x = NULL, y = NULL,
         caption = "(3-month-moving-avg, seasonally unadjusted)") +
    scale_fill_viridis(
      name = paste(report_month,
                   report_year,
                   "\nUnemployment\nRate"),
      direction = -1,
      begin = 0.3,
      end = 1,
      labels = percent_format(accuracy = 1),
      breaks = breaks_pretty(n = 5)
    ) +
    theme_minimal() +
    theme(
      legend.title = element_text(size = 11,
                                  colour = "grey20"),
      legend.text = element_text(size = 10,
                                 colour = "grey20"),
      plot.caption = element_text(
        size = 8,
        colour = "grey60",
        face = "italic",
        hjust = 1.3
      ),
      panel.grid.major = element_line(colour = "transparent"),
      axis.text = element_blank()
    )
# )
```


Row 3
---------------------------------------------------------------------------

### Number of Jobs in B.C. {.value-box}

```{r}
# recent monthly change in employment
recent_month_change_employment_bc <- lfc_province_tidy %>%
  filter(
    vector == "v2064701",
    date == max(date)
  )

valueBox(
  value = recent_month_change_employment_bc %>%
    pull(value) %>%
    signs(format = comma),
  # icon = "fa-users-cog",
  caption = paste("Number of Jobs in B.C. in", report_month)
)
```

### Month-Over-Month Change in Number of Jobs in B.C. {.value-box}

```{r}
valueBox(
  value = recent_month_change_employment_bc %>%
    pull(month_change) %>%
    signs(
      format = comma,
      add_plusses = TRUE
    ),
  # icon = "fa-users-cog",
  caption = "Month-Over-Month Change in Number of Jobs in B.C."
)
```

### Year-Over-Year Change in Number of Jobs in B.C. {.value-box}

```{r}
year_change_employment_bc <- lfc_province_tidy %>%
  filter(
    vector == "v2064701",
    date %in% c(max(date) - months(12), max(date))
  ) %>%
  mutate(
    year_change = value - lag(value),
    year_change_percent = value / lag(value) - 1
  ) %>%
  filter(date == max(date))

# year over year change employment
valueBox(
  value = year_change_employment_bc %>%
    pull(year_change) %>%
    signs(
      format = comma,
      add_plusses = TRUE
    ),
  # icon = "fa-users-cog",
  caption = paste("Year-Over-Year Change in Number of Jobs in B.C.")
)
```


Row 4
---------------------------------------------------------------------

### Monthly B.C. Unemployment Rates by Age & Sex for Since 1980

```{r, fig.width=7, fig.height=5}
unemploy_rt_bc_ag <- lfc_province_tidy %>%
  filter(
    date > "1979-12-01",
    geo == "British Columbia",
    labour_force_characteristics %in% c("Unemployment rate"),
    age_group %in% c("15 to 24 years",
                     "25 to 54 years",
                     "55 years and over"),
    sex != "Both sexes"
  ) %>%
  ggplot(aes(
    x = date,
    y = value,
    colour = age_group
  )) +
  geom_point(aes(text = paste(
      "Date:",
      date,
      "<br>",
      "Age Group:",
      age_group,
      "<br>",
      "Unemployment Rate:",
      signs(value,
            format = percent,
            accuracy = 0.1)
    )),
    alpha = 0.6) +
  geom_line(alpha = 0.8) +
  facet_wrap(facets = vars(sex)) +
  labs(x = NULL,
       y = NULL) +
  scale_y_continuous(labels = percent,
                     breaks = breaks_pretty(n = 6)) +
  scale_x_date(breaks = breaks_pretty(n = 6)) +
  scale_colour_viridis_d() +
  theme_minimal() +
  theme_facet_bar

ggplotly_lfs(unemploy_rt_bc_ag) %>%
  layout(legend = list(
    orientation = "h",
    x = 0.1,
    y = -0.2
  ))
```

### Month-Over-Month Change in Number of Jobs in B.C. in `r report_year` 

```{r, fig.width=7, fig.height=5}
ggplotly_lfs(lfc_province_tidy %>%
  filter(
    vector == "v2064701",
    date >= paste0(report_year, "-01-01")
  ) %>%
  {
    ggplot(
      .,
      aes(
        x = date,
        y = month_change,
        text = paste(
          "Number of Jobs:",
          signs(
            value,
            format = comma
          ),
          "<br>",
          "Month-Over-Month Change:",
          signs(
            month_change,
            format = comma,
            add_plusses = TRUE
          ),
          "<br>",
          "% Month-Over-Month Change:",
          signs(
            month_change_percent,
            format = percent,
            add_plusses = TRUE,
            accuracy = 0.1
          )
        )
      )
    ) +
      geom_col(
        fill = main_colour,
        alpha = 0.6
      ) +
      geom_text(
        aes(
          label = signs(
            month_change,
            format = comma,
            add_plusses = TRUE
          )
        ),
        nudge_y = ifelse(.$month_change > 0, 10000, -10000),
        colour = "grey20",
        size = 2.5
      ) +
      labs(
        x = NULL,
        y = NULL
      ) +
      scale_y_continuous(
        labels = comma,
        breaks = breaks_pretty(n = 8)
      ) +
      scale_x_date(breaks = breaks_pretty(n = 6)) +
      theme_minimal() +
      theme_vert_bar
  }
)
```


Row 5
----------------------------------------------------------------------------

### Month-Over-Month Change in Number of Jobs in B.C. by Age & Gender in `r report_year` 

```{r, fig.width=7, fig.height=5}
mom_change_employment_ag <- lfc_province_tidy %>%
  filter(
    date >= paste0(report_year, "-01-01"),
    geo == "British Columbia",
    labour_force_characteristics == "Employment",
    age_group %in% c("15 to 24 years",
                     "25 to 54 years",
                     "55 years and over")
  ) %>%
  mutate(sex = recode(sex, "Both sexes" = "All")) %>%
  filter(sex != "All") %>%
  ggplot(aes(
    x = date,
    y = month_change,
    text = paste(
      "Month-Over-Month Change:",
      signs(month_change,
            format = comma,
            add_plusses = TRUE),
      "<br>",
      "% Month-Over-Month Change:",
      signs(
        month_change_percent,
        format = percent,
        add_plusses = TRUE,
        accuracy = 0.1
      )
    )
  )) +
  geom_col(fill = main_colour,
           alpha = 0.6) +
  facet_grid(sex ~ age_group) +
  geom_text(
    aes(
      label = signs(
        month_change_percent,
        format = percent,
        add_plusses = TRUE,
        accuracy = 0.1
      )
    ),
    nudge_y = -5000,
    colour = "grey20",
    size = 2
  ) +
  labs(x = NULL,
       y = NULL) +
  scale_y_continuous(labels = comma,
                     breaks = breaks_pretty(5)) +
  scale_x_date(breaks = breaks_pretty(n = 4)) +
  theme_minimal() +
  theme_facet_bar
# theme(strip.text.y = element_text(angle = 0))

ggplotly_lfs(mom_change_employment_ag)
```


Sector
====================================================================


Row 1
---------------------------------------------------------------------

### Month-Over-Month Change in Number of Jobs in B.C. by Job Type in `r report_year` 

```{r, fig.width=7, fig.height=5}
ggplotly(lfc_province_tidy %>%
  filter(
    date >= paste0(report_year, "-01-01"),
    geo == "British Columbia",
    labour_force_characteristics %in% c("Full-time employment",
                                        "Part-time employment"),
    sex == "Both sexes",
    age_group == "15 years and over"
  ) %>%
  mutate(labour_force_characteristics = to_upper_camel_case(str_extract(
    labour_force_characteristics,
    "^([^,])+ "
  ), sep_out = "-")) %>% {
    ggplot(data = ., 
         aes(
    x = date,
    y = month_change,
    text = paste(
    "Number of Jobs:",
          signs(
            value,
            format = comma
          ),
          "<br>",
          "Month-Over-Month Change:",
          signs(
            month_change,
            format = comma,
            add_plusses = TRUE
          ),
          "<br>",
          "% Month-Over-Month Change:",
          signs(
            month_change_percent,
            format = percent,
            add_plusses = TRUE,
            accuracy = 0.1
      )
    )
  )) +
  geom_col(fill = main_colour,
           alpha = 0.6) +
  facet_wrap(
    facets = vars(labour_force_characteristics),
    nrow = 2
    # labeller = labeller(labour_force_characteristics = label_wrap_gen(width = 10))
  ) +
  geom_text(
    aes(
      label = signs(
        month_change,
        format = comma,
        add_plusses = TRUE
      )
    ),
    nudge_y = ifelse(.$month_change > 0, 16000, -16000),
    colour = "grey20",
    size = 2.5
  ) +
  labs(x = NULL,
       y = NULL) +
  scale_y_continuous(labels = comma,
                     breaks = breaks_pretty(n = 8)) +
  scale_x_date(breaks = breaks_pretty(n = 6)) +
  theme_minimal() +
  theme_facet_bar +
  theme(panel.spacing = unit(1, "lines"))
})
```

Row 2
-----------------------------------------------------------------------

### Month-Over-Month Change in Number of Jobs in B.C. by Sector in `r report_year` 

```{r, fig.width=7, fig.height=5}
ggplotly(employment_by_class_tidy %>%
  filter(
    class_of_worker %in% c(
      "Public sector employees",
      "Private sector employees",
      "Self-employed"
    ),
    date >= paste0(report_year, "-01-01")
  ) %>%
  mutate(class_of_worker = recode(class_of_worker,
                                  "Public sector employees" = "Public Sector",
                                  "Private sector employees" = "Private Sector",
                                  "Self-employed" = "Self-Employed")) %>% {
  ggplot(data = .,
         aes(
    x = date,
    y = month_change,
    text = paste(
  "Number of Jobs:",
          signs(
            value,
            format = comma
          ),
          "<br>",
          "Month-Over-Month Change:",
          signs(
            month_change,
            format = comma,
            add_plusses = TRUE
          ),
          "<br>",
          "% Month-Over-Month Change:",
          signs(
            month_change_percent,
            format = percent,
            add_plusses = TRUE,
            accuracy = 0.1
      )
    )
  )) +
  geom_col(fill = main_colour,
           alpha = 0.6) +
  facet_wrap(
    facets = vars(class_of_worker),
    nrow = 1
    # labeller = labeller(class_of_worker = label_wrap_gen(width = 15))
  ) +
  geom_text(
    aes(
      label = signs(
        month_change,
        format = comma,
        add_plusses = TRUE
      )
    ),
    nudge_y = ifelse(.$month_change > 0, 10000, -10000),
    colour = "grey20",
    size = 2.5
  ) +
  labs(x = NULL,
       y = NULL) +
  scale_y_continuous(labels = comma,
                     breaks = breaks_pretty(n = 6)) +
  scale_x_date(breaks = breaks_pretty(n = 4)) +
  theme_minimal() +
  theme_facet_bar
})
```


Industry
======================================================================


Row 1
-----------------------------------------------------------------------


National ðŸ‡¨ðŸ‡¦ 
======================================================================


Row 1
-----------------------------------------------------------------------

### CAN Unemployment Rate (%) for Recent Month {.value-box}

```{r}
#recent monthly change in unemployment for CAN
month_unemployment_rate_can <- lfc_province_tidy %>%
  filter(vector == "v2062815",
         date == max(date))

valueBox(
  value = month_unemployment_rate_can %>%
    pull(value) %>%
    signs(format = percent, accuracy = 0.1),
  # icon = "fa-users-cog",
  caption = paste("Canada Unemployment Rate in", report_month)
)
```


### Month-Over-Month Change in Canada Unemployment Rate {.value-box}

```{r}
#recent monthly change in unemployment for CAN
valueBox(
  value = month_unemployment_rate_can %>%
    pull(month_change) %>%
    signs(format = percent, accuracy = 0.1),
  # icon = "fa-users-cog",
  caption = paste("Month-Over-Month Change in Canada Unemployment Rate")
)
```

### Year-Over-Year Change in Canada Unemployment Rate {.value-box}

```{r}
#CAN year over year change unemployment rate
year_change_unemployment_rate_can <- lfc_province_tidy %>%
  filter(vector == "v2062815",
  date %in% c(max(date) - months(12), max(date))) %>% 
  mutate(year_change = value - lag(value)) %>% 
  filter(date == max(date))

valueBox(
  value = year_change_unemployment_rate_can %>%
    pull(year_change) %>%
    signs(
      format = percent,
      add_plusses = TRUE,
      accuracy = 0.1
    ),
  # icon = "fa-users-cog",
  caption = paste("Year-Over-Year Change in Canada Unemployment Rate")
)
```


Row 2
---------------------------------------------------------------------------

### Monthly Unemployment Rates by Province in `r report_year`

```{r, fig.width=7, fig.height=5}
ggplotly_lfs(lfc_province_tidy %>%
  filter(
    labour_force_characteristics == "Unemployment rate",
    sex == "Both sexes",
    age_group == "15 years and over",
    geo != "Canada",
    date >= paste0(report_year, "-01-01")
) %>% 
 ggplot(aes(
    x = date,
    y = value,
    colour = geo
  )) +
  geom_point(aes(text = paste(
      "Province:",
      geo,
      "<br>",
      "Date:",
      date,
      "<br>",
      "Unemployment Rate:",
      signs(value,
            format = percent,
            accuracy = 0.1)
    )),
    alpha = 0.6) +
  geom_line(alpha = 0.8) +
  labs(x = NULL,
       y = NULL) +
  scale_y_continuous(labels = percent,
                     breaks = breaks_pretty(n = 6)) +
  scale_colour_viridis_d(name = NULL) +
  scale_x_date(breaks = breaks_pretty(n = 6)) +
  theme_minimal() +
  theme_vert_bar
)
```


### Unemployment Rate for `r paste(report_month, report_year)` by Province

```{r, fig.width=7, fig.height=5}
unemploy_rt_provinces <- lfc_province_tidy %>%
  filter(
    labour_force_characteristics == "Unemployment rate",
    sex == "Both sexes",
    age_group == "15 years and over",
    date == max(date),
    geo != "Canada")

unemploy_rt_provinces_spatial <-  can_provinces %>% 
  left_join(unemploy_rt_provinces, by = c("name"= "geo"))

 # ggplotly_lfs(
  ggplot(unemploy_rt_provinces_spatial) +
  geom_sf(aes(fill = value, 
              text = paste0(report_month," ",report_year,"\n",
                            name,"\n","Unemployment Rate: ",
                            signs(value,
            format = percent,
            accuracy = 0.1)
    ))) +
   labs(x = NULL, y = NULL) +
  scale_fill_viridis(
    name = paste(report_month,
                 report_year,
                 "\nUnemployment\nRate"),
    direction = -1,
    begin = 0.3,
    end = 1,
    labels = percent_format(accuracy = 1),
    breaks = breaks_pretty(n = 5),
    na.value="white"
  ) +
  theme_minimal() +
  theme(
    legend.title = element_text(size = 11, 
                                colour = "grey20"),
    legend.text = element_text(size = 10,
                               colour = "grey20"),
    plot.caption = element_text(
      size = 8,
      colour = "grey60",
      face = "italic",
      hjust = 1.3
    ),
    panel.grid.major = element_line(colour = "transparent"),
    axis.text = element_blank()
  )
  # )
```


Row 3
----------------------------------------------------------------------------

### Number of Jobs in Canada in August {.value-box}

```{r}
#recent monthly change in CAN employment
month_change_employment_can <- lfc_province_tidy %>%
  filter(vector == "v2062811",
         date == max(date))

valueBox(
  value = month_change_employment_can %>%
    pull(value) %>%
    signs(format = comma),
  # icon = "fa-users-cog",
  caption = paste("Number of Jobs in Canada in", report_month)
)
```


### Month-Over-Month Change in Number of Jobs in Canada {.value-box}

```{r}
#recent monthly change in CAN employment
valueBox(
  value = month_change_employment_can %>%
    pull(month_change) %>%
    signs(format = comma,
          add_plusses = TRUE),
  # icon = "fa-users-cog",
  caption = "Month-Over-Month Change in Number of Jobs in Canada"
)
```


### Year-Over-Year Change in Number of Jobs in Canada {.value-box}

```{r}
year_change_employment_can <- lfc_province_tidy %>%
  filter(vector == "v2062811",
         date %in% c(max(date) - months(12), max(date))) %>% 
  mutate(
    year_change = value - lag(value),
    year_change_percent = value / lag(value) - 1
  ) %>% 
  filter(date == max(date))

#year over year change employment
valueBox(value = year_change_employment_can %>% 
  pull(year_change) %>%
  signs(format = comma,
        add_plusses = TRUE),
         # icon = "fa-users-cog",
         caption = paste("Year-Over-Year Change in Number of Jobs in Canada"))
```


Row 4
-----------------------------------------------------------------------


### Percent Month-Over-Month Change in Number of Jobs by Province in `r report_year`

```{r}
ggplotly_lfs(
  lfc_province_tidy %>%
  filter(
    labour_force_characteristics == "Employment",
    sex == "Both sexes",
    age_group == "15 years and over",
    geo != "Canada",
    date >= paste0(report_year, "-01-01")
  ) %>%
  mutate(fill_col = ifelse(geo == "British Columbia", "bc", "other")) %>%
  ggplot(aes(x = date, y = month_change_percent)) +
  geom_col(aes(fill = fill_col,
              text = paste(
      "Number of Jobs:",
      signs(
       value,
       format = comma),
      "<br>",       
      "Month-Over-Month Change:",
      signs(
       month_change,
       format = comma,
       add_plusses = TRUE),
      "<br>",
      "% Month-Over-Month Change:",
      signs(
        month_change_percent,
        format = percent,
        add_plusses = TRUE,
        accuracy = 0.1
      )
    )), alpha = 0.6) +
  coord_flip() +
  # geom_text(
  #   aes(
  #     label = signs(
  #       month_change_percent,
  #       format = percent,
  #       add_plusses = TRUE,
  #       accuracy = 0.1
  #     )
  #   ),
  #   nudge_y = 8000,
  #   colour = "grey20",
  #   size = 2.5
  # ) +
  facet_wrap(~ geo,
             ncol = 3) +
  labs(x = NULL,
       y = NULL) +
  scale_y_continuous(
    labels = percent,
    expand = c(0, 0),
    breaks = breaks_pretty(n = 6)
  ) +
  scale_fill_manual(guide = FALSE,
                    values = c(bc = "#440154FF",
                               other = main_colour)) +
  theme_minimal() +
  theme_horiz_bar +
  theme(legend.position = "none")
)
```


About {data-orientation=columns}
======================================================================


Column
-----------------------------------------------------------------------

Data are sourced from the [Statistics Canada Labour Force Survey (LFS)](https://www.statcan.gc.ca/eng/survey/household/3701), a monthly survey which measures the current state of the Canadian labour market. 
  
Statistics Canada data are released under the [Statistics Canada Open Licence](https://www.statcan.gc.ca/eng/reference/licence).
  
Statistics Canada Labour Force Survey Tables: 

 - [Statistics Canada Table **14-10-0287-03**: Labour force characteristics by province, monthly, seasonally adjusted](https://www150.statcan.gc.ca/t1/tbl1/en/tv.action?pid=1410028703)
 - [Statistics Canada Table **14-10-0293-02**: Labour force characteristics by economic region, three-month moving average, unadjusted for seasonality](https://www150.statcan.gc.ca/t1/tbl1/en/tv.action?pid=1410029302)
 - [Statistics Canada Table **14-10-0288-01**: Employment by class of worker, monthly, seasonally adjusted and unadjusted, last 5 months](https://www150.statcan.gc.ca/t1/tbl1/en/tv.action?pid=1410028801) 
 
 <!--
 - [Statistics Canada Table **14-10-0127-01**: Reason for not looking for work, monthly, unadjusted for seasonality](https://www150.statcan.gc.ca/t1/tbl1/en/tv.action?pid=1410012701&pickMembers%5B0%5D=1.11&pickMembers%5B1%5D=3.1&pickMembers%5B2%5D=4.1) 
 -->
 
B.C. Data Catalogue:
 - [Current Census Economic Regions](https://catalogue.data.gov.bc.ca/dataset/1aebc451-a41c-496f-8b18-6f414cde93b7)

This report is built with the [`flexdashboard` R package](https://rmarkdown.rstudio.com/flexdashboard/), sourcing the Statistics Canada Labour Force Survey data using the [`cansim` R package](https://mountainmath.github.io/cansim/index.html), and the British Columbia economic geospatial data using the [`bcdata` R package](https://bcgov.github.io/bcdata/). 
  
The [R](https://www.r-project.org/) code is available in [bcgov GitHub](https://github.com/bcgov/labour-force-survey-digest), made available under the [Apache 2.0 licence](https://github.com/bcgov/labour-force-survey-digest/blob/master/LICENSE).
